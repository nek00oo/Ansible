# –†–æ–ª—å: nginx (—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ Nginx –≤ Docker)

–≠—Ç–∞ Ansible-—Ä–æ–ª—å —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç –≤–µ–±-—Å–µ—Ä–≤–µ—Ä **Nginx** –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **Docker**.  
–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ HTTP-, —Ç–∞–∫ –∏ HTTPS-—Ä–µ–∂–∏–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

---

## üîß –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Ä–æ–ª—å

- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Docker-–¥–≤–∏–∂–æ–∫ (—á–µ—Ä–µ–∑ `apt`, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)  
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç Docker-–æ–±—Ä–∞–∑ Nginx  
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, –µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω HTTPS –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç  
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –ø—Ä–æ–±—Ä–æ—à–µ–Ω–Ω—ã–º–∏ –ø–æ—Ä—Ç–∞–º–∏ –∏ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–º —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º  
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ  

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ `roles/nginx/defaults/main.yml`)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-------------|-------------|------------------------|
| `nginx_image` | –ò–º—è Docker-–æ–±—Ä–∞–∑–∞ | `nginx` |
| `nginx_image_tag` | –¢–µ–≥ Docker-–æ–±—Ä–∞–∑–∞ | `stable` |
| `nginx_container_name` | –ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ | `nginx_web` |
| `nginx_host_http_port` | HTTP-–ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç–µ | `80` |
| `nginx_host_https_port` | HTTPS-–ø–æ—Ä—Ç –Ω–∞ —Ö–æ—Å—Ç–µ | `443` |
| `nginx_static_host_path` | –ü—É—Ç—å –∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∞–π–ª–∞–º –Ω–∞ —Ö–æ—Å—Ç–µ | `/var/www/html` |
| `nginx_static_container_path` | –ü—É—Ç—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏ | `/usr/share/nginx/html` |
| `use_https` | –í–∫–ª—é—á–∏—Ç—å HTTPS (true/false) | `false` |
| `ssl_cert_path` | –ü—É—Ç—å –∫ SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É –Ω–∞ —Ö–æ—Å—Ç–µ | `/etc/nginx/ssl/nginx.crt` |
| `ssl_key_path` | –ü—É—Ç—å –∫ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É –Ω–∞ —Ö–æ—Å—Ç–µ | `/etc/nginx/ssl/nginx.key` |
| `domain` | –î–æ–º–µ–Ω (–∑–Ω–∞—á–µ–Ω–∏–µ `server_name` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx) | `localhost` |

---


```bash
# install collection
ansible-galaxy collection install community.docker


# run playbook (http)
ansible-playbook -i tests/inventory tests/test.yml -e "use_https=false"


# run playbook (https on custom host port 10320)
ansible-playbook -i tests/inventory tests/test.yml -e "use_https=true nginx_host_https_port=10320 domain=group-3-st-10-2.itmo.devops-teta.ru"
```